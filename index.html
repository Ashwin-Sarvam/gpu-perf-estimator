<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Inference Performance & Cost Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ§  LLM Inference Performance</h1>
            <p>An interactive tool to get roofline estimates of LLM inference metrics on NVIDIA Hopper & Blackwell GPUs.</p>
        </header>

        <main>
            <div class="controls", style="margin-top: 20px; align-items: center;">
                <h2>Configuration</h2>
                <div class="form-group">
                    <label for="modelId">Hugging Face Model ID</label>
                    <input type="text" id="modelId" value="deepseek-ai/DeepSeek-V3.1">
                </div>
                 <div class="form-group-inline">
                    <input type="checkbox" id="manualParamsToggle">
                    <label for="manualParamsToggle">Manually enter model parameters?</label>
                </div>
                <div id="manualParamsSection" class="hidden">
                     <div class="form-group">
                        <label for="totalParamsManual">Total Parameters (in billions)</label>
                        <input type="number" id="totalParamsManual" value="671" step="0.1">
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputLen">Max Input Sequence Length</label>
                    <input type="number" id="inputLen" value="2048">
                </div>
                <div class="form-group">
                    <label for="outputLen">Max Output Sequence Length</label>
                    <input type="number" id="outputLen" value="1024">
                </div>
                <div class="form-group">
                    <label for="hardware">Target Hardware</label>
                    <select id="hardware">
                        <option value="H100 SXM">H100 SXM</option>
                        <option value="H200 SXM">H200 SXM</option>
                        <option value="B200 SXM">B200 SXM</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="precision">Inference Precision</label>
                    <select id="precision">
                        <option value="FP8">FP8</option>
                        <option value="FP16">FP16</option>
                        <option value="FP4">FP4</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="numNodes">Number of Nodes</label>
                    <input type="number" id="numNodes" value="8">
                </div>
                <div class="form-group">
                    <label for="tensorParallel">Tensor Parallelism (GPUs per model)</label>
                    <input type="number" id="tensorParallel" value="16" min="1" max="8">
                    <small>Number of GPUs used for tensor parallelism (1-8)</small>
                </div>
                <div class="form-group">
                    <label for="gpuCost">GPU Cost per Hour ($)</label>
                    <input type="number" id="gpuCost" value="2.50" step="0.01">
                </div>
                <button id="calculateBtn">Calculate Performance & Cost</button>
            </div>

            <div class="results">
                <h2>ðŸ“Š Results</h2>
                <div id="loader" class="hidden"></div>
                <div id="resultsContent" class="hidden">
                    <div class="results-grid">
                        <div class="metric-card">
                            <h3>System & Batching</h3>
                            <p>Max Batch Size (per Replica): <strong id="res-batchSize">--</strong></p>
                            <p>Model Weights Memory: <strong id="res-modelMem">-- GB</strong></p>
                            <p>Max KV Cache Memory: <strong id="res-kvMem">-- GB</strong></p>
                            <p>Tensor Parallelism: <strong id="res-tensorParallel">--</strong></p>
                        </div>
                        <div class="metric-card">
                            <h3>Performance</h3>
                            <p>Prefill Latency (TTFT): <strong id="res-latency">-- ms</strong></p>
                            <p>Decode Throughput (per Replica): <strong id="res-nodeTput">-- tok/s</strong></p>
                            <p>Decode Throughput (per Request): <strong id="res-requestTput">-- tok/s</strong></p>
                            <p>Total System Throughput: <strong id="res-sysTput">-- tok/s</strong></p>
                        </div>
                         <div class="metric-card">
                            <h3>ðŸ’° Economic Analysis</h3>
                            <p>Input Token Cost / Million: <strong id="res-inputCost">$--</strong></p>
                            <p>Output Token Cost / Million: <strong id="res-outputCost">$--</strong></p>
                        </div>
                    </div>
                     <details>
                        <summary>View Fetched Model Parameters</summary>
                        <div id="res-modelParams">
                            <div id="res-modelParamsSummary" class="model-params-summary"></div>
                            <details>
                                <summary>Full Configuration JSON</summary>
                                <pre id="res-modelParamsFull">Model parameters will be shown here...</pre>
                            </details>
                        </div>
                    </details>
                </div>
                <div id="error" class="hidden"></div>
            </div>
        </main>
    </div>
    <script src="script.js"></script>
</body>
</html>